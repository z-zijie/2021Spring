[CODE]

clear
% Declare Matrix Z
Z = [1     2     3;
     4     5     6;
     7     8     7;
     4     2     3;
     4     2     2]
e = eye(3);
E = eye(5);

% First Step
A0 = Z;
x = A0 * e(:, 1)
y = norm(x,2) * E(:, 1)
w = (x-y) / norm(x-y, 2)
H1 = E - 2 * w * w'
A1 = H1 * A0

% Second Step
x = A1 * e(:, 2)
y = x(1) * E(:, 1) + norm(x(2:5),2) * E(:, 2)
w = (x-y) / norm(x-y, 2)
H2 = E - 2 * w * w'
A2 = H2 * A1

% Third Step
x = A2 * e(:, 3);
y = x(1) * E(:, 1) + x(2) * E(:, 2) + norm(x(3:5),2) * E(:, 3)
w = (x-y) / norm(x-y, 2)
H3 = E - 2 * w * w'
A3 = H3 * A2

% Calc q and r
q = H1 * H2 * H3
r = H3 * H2 * H1 * Z

% Use qr routine
[Q R] = qr(Z)


[OUTPUT]

>> Q1

Z =

     1     2     3
     4     5     6
     7     8     7
     4     2     3
     4     2     2


x =

     1
     4
     7
     4
     4


y =

    9.8995
         0
         0
         0
         0


w =

   -0.6704
    0.3013
    0.5273
    0.3013
    0.3013


H1 =

    0.1010    0.4041    0.7071    0.4041    0.4041
    0.4041    0.8184   -0.3178   -0.1816   -0.1816
    0.7071   -0.3178    0.4438   -0.3178   -0.3178
    0.4041   -0.1816   -0.3178    0.8184   -0.1816
    0.4041   -0.1816   -0.3178   -0.1816    0.8184


A1 =

    9.8995    9.4954    9.6975
         0    1.6311    2.9897
    0.0000    2.1044    1.7320
         0   -1.3689   -0.0103
         0   -1.3689   -1.0103


x =

    9.4954
    1.6311
    2.1044
   -1.3689
   -1.3689


y =

    9.4954
    3.2919
         0
         0
         0


w =

         0
   -0.5023
    0.6364
   -0.4140
   -0.4140


H2 =

    1.0000         0         0         0         0
         0    0.4955    0.6393   -0.4158   -0.4158
         0    0.6393    0.1900    0.5269    0.5269
         0   -0.4158    0.5269    0.6572   -0.3428
         0   -0.4158    0.5269   -0.3428    0.6572


A2 =

    9.8995    9.4954    9.6975
    0.0000    3.2919    3.0129
    0.0000    0.0000    1.7026
    0.0000    0.0000    0.0089
    0.0000   -0.0000   -0.9911


y =

    9.6975
    3.0129
    1.9701
         0
         0


w =

         0
         0
   -0.2606
    0.0086
   -0.9654


H3 =

    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    0.8642    0.0045   -0.5031
         0         0    0.0045    0.9999    0.0167
         0         0   -0.5031    0.0167   -0.8641


A3 =

    9.8995    9.4954    9.6975
    0.0000    3.2919    3.0129
   -0.0000    0.0000    1.9701
    0.0000    0.0000   -0.0000
   -0.0000    0.0000    0.0000


q =

    0.1010    0.3162    0.5420    0.3408   -0.6928
    0.4041    0.3534    0.5162   -0.5730    0.3422
    0.7071    0.3906   -0.5248    0.2684    0.0028
    0.4041   -0.5580    0.3871    0.5006    0.3534
    0.4041   -0.5580   -0.1204   -0.4825   -0.5273


r =

    9.8995    9.4954    9.6975
         0    3.2919    3.0129
   -0.0000   -0.0000    1.9701
    0.0000         0    0.0000
   -0.0000   -0.0000   -0.0000


Q =

   -0.1010   -0.3162    0.5420   -0.6842   -0.3577
   -0.4041   -0.3534    0.5162    0.3280    0.5812
   -0.7071   -0.3906   -0.5248    0.0094   -0.2683
   -0.4041    0.5580    0.3871    0.3656   -0.4918
   -0.4041    0.5580   -0.1204   -0.5390    0.4695


R =

   -9.8995   -9.4954   -9.6975
         0   -3.2919   -3.0129
         0         0    1.9701
         0         0         0
         0         0         0
